<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title><%= title %></title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css" rel="stylesheet">
    <link href="/css/style.css" rel="stylesheet">
</head>
<body class="auth-page bg-light">
    <%- include('../layouts/main', { 
        body: `
            <div class="auth-container">
                <div class="container">
                    <div class="row justify-content-center align-items-center min-vh-100 py-5">
                        <div class="col-lg-10 col-xl-9">
                            <div class="card border-0 shadow-lg">
                                <div class="row g-0">
                                    <!-- Left Panel - Branding -->
                                    <div class="col-lg-5 d-none d-lg-flex bg-gradient-primary text-white">
                                        <div class="card-body d-flex flex-column justify-content-center align-items-center text-center p-5">
                                            <div class="mb-5">
                                                <i class="bi bi-mortarboard-fill display-1 mb-4 hero-illustration"></i>
                                                <h1 class="display-4 fw-bold mb-3">Trackademic</h1>
                                                <p class="lead opacity-90">
                                                    Únete a miles de estudiantes que ya están mejorando su rendimiento académico con nosotros.
                                                </p>
                                            </div>
                                            
                                            <div class="row g-4 w-100" style="max-width: 350px;">
                                                <div class="col-12">
                                                    <div class="d-flex align-items-center">
                                                        <i class="bi bi-rocket-takeoff text-warning me-3" style="font-size: 1.5rem;"></i>
                                                        <div class="text-start">
                                                            <h6 class="mb-1">Comienza Gratis</h6>
                                                            <small class="opacity-75">Registrarte toma menos de un minuto</small>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="col-12">
                                                    <div class="d-flex align-items-center">
                                                        <i class="bi bi-shield-check text-success me-3" style="font-size: 1.5rem;"></i>
                                                        <div class="text-start">
                                                            <h6 class="mb-1">Datos Seguros</h6>
                                                            <small class="opacity-75">Protegemos tu información</small>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="col-12">
                                                    <div class="d-flex align-items-center">
                                                        <i class="bi bi-headset text-info me-3" style="font-size: 1.5rem;"></i>
                                                        <div class="text-start">
                                                            <h6 class="mb-1">Soporte 24/7</h6>
                                                            <small class="opacity-75">Te ayudamos cuando lo necesites</small>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- Right Panel - Register Form -->
                                    <div class="col-lg-7">
                                        <div class="card-body p-5">
                                            <div class="text-center mb-4">
                                                <div class="d-lg-none mb-4">
                                                    <i class="bi bi-mortarboard-fill text-primary" style="font-size: 3rem;"></i>
                                                    <h2 class="text-primary fw-bold">Trackademic</h2>
                                                </div>
                                                <h3 class="fw-bold mb-2">Crear Cuenta</h3>
                                                <p class="text-muted">Regístrate para comenzar a gestionar tus notas</p>
                                            </div>

                                            <!-- Error Alert -->
                                            <% if (error) { %>
                                                <div class="alert alert-danger alert-dismissible fade show" role="alert">
                                                    <i class="bi bi-exclamation-triangle-fill me-2"></i>
                                                    <%= error %>
                                                    <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                                                </div>
                                            <% } %>

                                            <form action="/register" method="POST" id="registerForm" novalidate>
                                                <div class="row">
                                                    <div class="col-md-6 mb-3">
                                                        <label for="firstName" class="form-label fw-semibold">
                                                            <i class="bi bi-person me-1"></i>Nombre
                                                        </label>
                                                        <input 
                                                            type="text" 
                                                            class="form-control" 
                                                            id="firstName" 
                                                            name="firstName" 
                                                            required
                                                            placeholder="Tu nombre"
                                                            pattern="[A-Za-zÀ-ÿ\\s]{2,}"
                                                            title="El nombre debe tener al menos 2 caracteres y solo letras"
                                                            autofocus
                                                        >
                                                        <div class="invalid-feedback">
                                                            Por favor ingresa un nombre válido.
                                                        </div>
                                                    </div>
                                                    <div class="col-md-6 mb-3">
                                                        <label for="lastName" class="form-label fw-semibold">
                                                            <i class="bi bi-person me-1"></i>Apellido
                                                        </label>
                                                        <input 
                                                            type="text" 
                                                            class="form-control" 
                                                            id="lastName" 
                                                            name="lastName" 
                                                            required
                                                            placeholder="Tu apellido"
                                                            pattern="[A-Za-zÀ-ÿ\\s]{2,}"
                                                            title="El apellido debe tener al menos 2 caracteres y solo letras"
                                                        >
                                                        <div class="invalid-feedback">
                                                            Por favor ingresa un apellido válido.
                                                        </div>
                                                    </div>
                                                </div>

                                                <div class="mb-3">
                                                    <label for="email" class="form-label fw-semibold">
                                                        <i class="bi bi-envelope me-1"></i>Correo Electrónico
                                                    </label>
                                                    <input 
                                                        type="email" 
                                                        class="form-control" 
                                                        id="email" 
                                                        name="email" 
                                                        required
                                                        placeholder="tu.email@universidad.edu"
                                                        autocomplete="email"
                                                    >
                                                    <div class="invalid-feedback">
                                                        Por favor ingresa un email válido.
                                                    </div>
                                                </div>

                                                <div class="mb-3">
                                                    <label for="password" class="form-label fw-semibold">
                                                        <i class="bi bi-lock me-1"></i>Contraseña
                                                    </label>
                                                    <div class="input-group">
                                                        <input 
                                                            type="password" 
                                                            class="form-control" 
                                                            id="password" 
                                                            name="password" 
                                                            required
                                                            placeholder="Mínimo 6 caracteres"
                                                            minlength="6"
                                                            autocomplete="new-password"
                                                        >
                                                        <button 
                                                            class="btn btn-outline-secondary" 
                                                            type="button" 
                                                            id="togglePassword"
                                                            aria-label="Mostrar/ocultar contraseña"
                                                            tabindex="-1"
                                                        >
                                                            <i class="bi bi-eye"></i>
                                                        </button>
                                                    </div>
                                                    <div class="invalid-feedback">
                                                        La contraseña debe tener al menos 6 caracteres.
                                                    </div>
                                                    <div class="form-text">
                                                        <small class="text-muted">
                                                            <i class="bi bi-info-circle me-1"></i>
                                                            Recomendamos usar una combinación de letras, números y símbolos.
                                                        </small>
                                                    </div>
                                                </div>

                                                <div class="mb-3">
                                                    <label for="confirmPassword" class="form-label fw-semibold">
                                                        <i class="bi bi-lock-fill me-1"></i>Confirmar Contraseña
                                                    </label>
                                                    <input 
                                                        type="password" 
                                                        class="form-control" 
                                                        id="confirmPassword" 
                                                        name="confirmPassword" 
                                                        required
                                                        placeholder="Repite tu contraseña"
                                                        autocomplete="new-password"
                                                    >
                                                    <div class="invalid-feedback">
                                                        Las contraseñas no coinciden.
                                                    </div>
                                                </div>

                                                <div class="mb-4">
                                                    <div class="form-check">
                                                        <input 
                                                            class="form-check-input" 
                                                            type="checkbox" 
                                                            id="agreeTerms" 
                                                            name="agreeTerms" 
                                                            required
                                                        >
                                                        <label class="form-check-label" for="agreeTerms">
                                                            <small>
                                                                Acepto los <a href="#" class="text-decoration-none">términos y condiciones</a> 
                                                                y la <a href="#" class="text-decoration-none">política de privacidad</a>
                                                            </small>
                                                        </label>
                                                        <div class="invalid-feedback">
                                                            Debes aceptar los términos y condiciones.
                                                        </div>
                                                    </div>
                                                </div>

                                                <div class="d-grid gap-2 mb-4">
                                                    <button type="submit" class="btn btn-primary btn-lg" id="registerBtn">
                                                        <i class="bi bi-person-plus me-2"></i>Crear Cuenta
                                                    </button>
                                                </div>
                                            </form>

                                            <div class="text-center">
                                                <p class="text-muted mb-3">¿Ya tienes una cuenta?</p>
                                                <a href="/login" class="btn btn-outline-primary">
                                                    <i class="bi bi-box-arrow-in-right me-2"></i>Iniciar Sesión
                                                </a>
                                            </div>

                                            <div class="text-center mt-4">
                                                <small class="text-muted">
                                                    <a href="/" class="text-decoration-none">
                                                        <i class="bi bi-arrow-left me-1"></i>Volver al inicio
                                                    </a>
                                                </small>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <script>
                document.addEventListener('DOMContentLoaded', function() {
                    // Toggle password visibility
                    const togglePassword = document.getElementById('togglePassword');
                    if (togglePassword) {
                        togglePassword.addEventListener('click', function() {
                            const passwordField = document.getElementById('password');
                            const icon = this.querySelector('i');
                            
                            if (passwordField.type === 'password') {
                                passwordField.type = 'text';
                                icon.className = 'bi bi-eye-slash';
                            } else {
                                passwordField.type = 'password';
                                icon.className = 'bi bi-eye';
                            }
                        });
                    }

                    // Form validation and submission
                    const registerForm = document.getElementById('registerForm');
                    if (registerForm) {
                        registerForm.addEventListener('submit', function(e) {
                            e.preventDefault();
                            
                            // Reset validation states
                            const inputs = this.querySelectorAll('.form-control, .form-check-input');
                            inputs.forEach(input => {
                                input.classList.remove('is-invalid', 'is-valid');
                            });
                            
                            let isValid = true;
                            
                            // Validate fields
                            const firstName = document.getElementById('firstName');
                            const lastName = document.getElementById('lastName');
                            const email = document.getElementById('email');
                            const password = document.getElementById('password');
                            const confirmPassword = document.getElementById('confirmPassword');
                            const agreeTerms = document.getElementById('agreeTerms');
                            
                            // First name validation
                            if (!firstName.value || !firstName.checkValidity()) {
                                firstName.classList.add('is-invalid');
                                isValid = false;
                            } else {
                                firstName.classList.add('is-valid');
                            }
                            
                            // Last name validation
                            if (!lastName.value || !lastName.checkValidity()) {
                                lastName.classList.add('is-invalid');
                                isValid = false;
                            } else {
                                lastName.classList.add('is-valid');
                            }
                            
                            // Email validation
                            if (!email.value || !email.checkValidity()) {
                                email.classList.add('is-invalid');
                                isValid = false;
                            } else {
                                email.classList.add('is-valid');
                            }
                            
                            // Password validation
                            if (!password.value || password.value.length < 6) {
                                password.classList.add('is-invalid');
                                isValid = false;
                            } else {
                                password.classList.add('is-valid');
                            }
                            
                            // Confirm password validation
                            if (!confirmPassword.value || confirmPassword.value !== password.value) {
                                confirmPassword.classList.add('is-invalid');
                                isValid = false;
                            } else {
                                confirmPassword.classList.add('is-valid');
                            }
                            
                            // Terms validation
                            if (!agreeTerms.checked) {
                                agreeTerms.classList.add('is-invalid');
                                isValid = false;
                            } else {
                                agreeTerms.classList.add('is-valid');
                            }
                            
                            if (isValid) {
                                // Show loading state
                                const btn = document.getElementById('registerBtn');
                                const originalText = btn.innerHTML;
                                btn.innerHTML = '<i class="bi bi-hourglass-split me-2"></i>Creando cuenta...';
                                btn.disabled = true;
                                
                                // Submit form
                                setTimeout(() => {
                                    this.submit();
                                }, 500);
                            }
                        });
                    }

                    // Real-time password confirmation
                    const password = document.getElementById('password');
                    const confirmPassword = document.getElementById('confirmPassword');
                    
                    if (password && confirmPassword) {
                        confirmPassword.addEventListener('input', function() {
                            if (this.value && this.value !== password.value) {
                                this.classList.add('is-invalid');
                                this.classList.remove('is-valid');
                            } else if (this.value === password.value && this.value.length >= 6) {
                                this.classList.add('is-valid');
                                this.classList.remove('is-invalid');
                            } else {
                                this.classList.remove('is-valid', 'is-invalid');
                            }
                        });
                    }
                    
                    // Auto-focus on first field
                    const firstNameField = document.getElementById('firstName');
                    if (firstNameField) {
                        firstNameField.focus();
                    }
                });
            </script>

            <style>
                .auth-container {
                    background: linear-gradient(135deg, var(--gray-50) 0%, #ffffff 50%, var(--gray-100) 100%);
                    position: relative;
                    min-height: 100vh;
                }
                
                .auth-container::before {
                    content: '';
                    position: absolute;
                    top: 0;
                    left: 0;
                    right: 0;
                    bottom: 0;
                    background: radial-gradient(circle at 30% 20%, rgba(37, 99, 235, 0.1) 0%, transparent 50%),
                                radial-gradient(circle at 70% 80%, rgba(16, 185, 129, 0.1) 0%, transparent 50%);
                    pointer-events: none;
                }
                
                .card {
                    position: relative;
                    z-index: 1;
                }
                
                .form-control.is-valid {
                    border-color: var(--success-color);
                    box-shadow: 0 0 0 0.2rem rgba(16, 185, 129, 0.25);
                }
                
                .form-control.is-invalid {
                    border-color: var(--danger-color);
                    box-shadow: 0 0 0 0.2rem rgba(239, 68, 68, 0.25);
                }
            </style>
        `
    }) %>
</body>
</html> 